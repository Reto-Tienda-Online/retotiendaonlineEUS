import{a as N,o as v,c as y,b as e,t as m,d as u,u as Q,j as Y,r,B as G,C as X,k as Z,i as f,s as ee,f as d,A as p,g as J,D as te,q as oe,v as C,F as L,m as se,E as O}from"./index-T2RBepq2.js";const ae={class:"bg-background text-white rounded-xl mt-5 mb-10"},le={class:"flex flex-row align-middle pt-5 ml-5 rounded-xl"},ne={class:"w-14 h-14 bg-resaltar rounded-full flex items-center justify-center font-bold text-white"},re={class:"ml-5 text-center text-lg font-semibold hover:underline cursor-pointer"},ie={class:"p-5"},ce={class:"flex justify-between items-center -mt-8"},de={class:"mt-0 flex items-center space-x-4 py-6"},ue={class:"mt-0"},me={class:"ml-5 text-sm font-semibold"},ge={class:"flex -mt-2"},he={class:"mt-4 text-md"},ve={__name:"Comentario",props:{comentario:Object,required:!0},setup(g){return(x,_)=>{const l=N("font-awesome-icon");return v(),y("div",ae,[e("div",le,[e("div",ne,m(g.comentario.nombre_usuario.slice(0,2).toUpperCase()),1),e("h1",re,m(g.comentario.titulo),1)]),e("div",ie,[e("div",ce,[e("div",de,[e("div",ue,[u(l,{icon:"user"})]),e("div",me,m(g.comentario.nombre_usuario),1)])]),e("div",ge,[e("span",null,m("⭐".repeat(g.comentario.valoracion)),1)]),e("p",he,m(g.comentario.comentario),1)])])}}},xe={class:"mx-20"},_e=e("div",null,[e("div"),e("div")],-1),fe={class:"grid grid-cols-9 gap-4 mb-1"},pe={class:"col-span-6"},be=["src"],we={class:"col-span-3 flex flex-col justify-between bg-background rounded-xl"},ye={class:"flex flex-col p-2"},Se=e("h1",{class:"text-white mt-5 text-4xl text-center"},"Jokoari buruz",-1),je={class:"text-white mt-5 mb-5 text-center"},ke={class:"bg-background p-2 mt-2 rounded-xl"},Ie={class:"text-white text-center text-4xl mt-5"},$e={class:"mt-2 flex flex-row justify-center align-middle"},Ce=e("h3",{class:"text-white text-center my-auto font-bold uppercase mr-2"}," Plataforma: ",-1),Je=["src"],Le={class:"text-white text-center my-auto ml-3"},Ne={class:"text-white flex flex-row justify-center mt-2"},Oe=e("h3",{class:"text-center uppercase my-auto font-bold mr-2"}," Prezioa: ",-1),Be={class:"text-center"},Fe={class:"flex flex-row justify-center align-middle"},De={class:"mt-5 bg-background rounded-xl mb-2"},Ee={class:"flex flex-row"},Pe={class:"flex flex-row justify-between items-center align-middle"},Te={class:"flex flex-row gap-2 rounded-xl"},Ue=e("button",{"aria-label":"Enviar comentario",class:"-mt-5 px-4 py-1 m-10 rounded-xl text-white bg-resaltar"}," Komentatu ",-1),Ae={class:"flex flex-col mt-10 mx-20"},qe={class:"flex flex-row justify-center gap-5"},Me={class:"text-white flex items-center justify-center uppercase font-bold"},Ve={class:"text-white flex items-center justify-center uppercase font-bold"},ze={class:"text-gray-200 text-4xl font-barlow"},Re={class:"grid grid-cols-3 gap-10"},He={__name:"Juego",setup(g){const x=Q(),_=Y(),l=r({}),S=r([]),n=G({resena:"",id_usuario:null,contenido:"",id_juego:null,valoracion:5}),h=r([]),j=r(3),b=r(0),k=r(3),w=r(1),B=r(0),i=r(""),I=r(!1),F=()=>{var a;const o=(a=JSON.parse(localStorage.getItem("usuario")))==null?void 0:a.id;o!==void 0?n.id_usuario=o:x.push("/login"),n.id_juego=l.value.id;let t=JSON.stringify(n),s={method:"post",maxBodyLength:1/0,url:"http://85.50.79.98:8080/resenas/",headers:{"Content-Type":"application/json"},data:t};f.request(s).then(c=>{console.log(JSON.stringify(c.data)),n.resena="",n.contenido="",alert("Comentario enviado con éxito")}).catch(c=>{console.log(c)})},D=o=>`/imgs/juegos/${o}/2.webp`,E=o=>`/imgs/logos/${o}.png`,P=X(()=>{if(i.value=l.value.descripcion,i.value)return i.value.length>=200?(i.value=i.value.slice(0,200),i.value=i.value.slice(0,i.value.lastIndexOf(" ")),!0):!1}),T=()=>{I.value=!I.value},U=o=>{const t=JSON.parse(localStorage.getItem("usuario")).id,s=JSON.stringify({id_usuario:t,id_producto:o.id}),a={method:"post",maxBodyLength:1/0,url:"http://85.50.79.98:8080/carrocompra",headers:{"Content-Type":"application/json"},data:s};f.request(a).then(c=>{console.log(JSON.stringify(c.data))}).catch(c=>{console.log(c)})},A=o=>{if(q(o))alert("Ya está en el carrito");else if(JSON.parse(localStorage.getItem("isLoggedIn")))try{_.commit("setShopItems",o),localStorage.setItem("shopcart",JSON.stringify(_.state.shopCart)),U(o),alert(`El juego ${o.producto} se ha añadido al carrito`),x.push("/cesta")}catch(s){console.error(s)}else alert("Es necesario iniciar sesión"),x.push("/login")},q=o=>{let t=!1;if(S.value.length>0)for(const s of S.value)if(s.producto.id===o.id){t=!0;break}else t=!1;return t},M=o=>{document.getElementById("iconoFav").classList.contains("text-red-600")?(z(o),document.getElementById("iconoFav").classList.toggle("text-white")):(V(o),document.getElementById("iconoFav").classList.toggle("text-red-600"))},V=async o=>{const t={id_usuario:JSON.parse(localStorage.getItem("usuario")).id,id_producto:o};try{const s=await f.post("listadeseo",t);console.log("Añadido a favoritos")}catch(s){console.error(s)}},z=async o=>{const t={id_usuario:JSON.parse(localStorage.getItem("usuario")).id,id_producto:o};try{const s=await f.delete(`listadeseo/${t.id_usuario}/${t.id_producto}`);console.log("Quitando de favoritos")}catch(s){console.error(s)}},R=()=>{const o=`http://85.50.79.98:8080/resena/${l.value.id}`;f.get(o).then(t=>{h.value=t.data,console.log(h.value)}).catch(t=>{console.error(t)})},H=()=>{b.value-=3,k.value-=3,w.value--},K=()=>{b.value+=3,k.value+=3,w.value++,console.log(w.value)};var $=!0;function W(){x.push("/login")}return Z(()=>{var t;_.state.juegoDetalle&&(l.value=_.state.juegoDetalle),Object.keys(l.value).length===0&&(l.value=JSON.parse(localStorage.getItem("juegoDetalle")));const o=(t=JSON.parse(localStorage.getItem("usuario")))==null?void 0:t.id;if(o!==void 0){const s=`http://85.50.79.98:8080/carrocompra?id_usuario=${o}`;n.id_usuario=o,f.get(s).then(a=>{S.value=a.data}).catch(a=>{console.error(a)})}R(),B.value=Math.ceil(h.value.length/j.value),o!==void 0?$=!1:$=!0}),(o,t)=>{const s=N("font-awesome-icon");return v(),y(L,null,[u(ee),e("div",xe,[_e,e("div",fe,[e("div",pe,[e("picture",null,[e("img",{alt:"Imagen del juego",class:"picture rounded-xl h-full",src:D(l.value.id),loading:"lazy"},null,8,be)])]),e("div",we,[e("div",ye,[Se,e("p",je,m(I.value===!0?l.value.descripcion:i.value),1),d(e("p",{onClick:T,class:"text-white hover:underline cursor-pointer text-center"}," Irakurri gehiago... ",512),[[p,P.value]])]),e("div",ke,[e("h1",Ie,m(l.value.producto),1),e("div",$e,[Ce,e("img",{src:E(l.value.nombreplataforma),alt:"Imagen de la plataforma",class:"w-10"},null,8,Je),e("h4",Le,m(l.value.nombreplataforma),1)]),e("div",Ne,[Oe,e("h3",Be,m(l.value.precio_unitario)+" €",1)]),e("div",Fe,[e("button",{"aria-label":"Add to cart",class:"text-white font-black bg-resaltar p-2 mt-1 w-full rounded-lg",onClick:t[0]||(t[0]=a=>A(l.value))},[u(s,{icon:"shopping-cart"}),J(" Add to cart ")]),te($)?(v(),y("button",{key:0,"aria-label":"Favorito",onClick:W,class:"text-white text-2xl ml-3 mr-3 rounded-xl"},[u(s,{id:"iconoFav",icon:"heart",class:"text-white"})])):(v(),y("button",{key:1,"aria-label":"Favorito",onClick:t[1]||(t[1]=a=>M(l.value.id)),class:"text-white text-2xl ml-3 mr-3 rounded-xl"},[u(s,{id:"iconoFav",icon:"heart",class:oe({"text-red-600":l.value.favorito})},null,8,["class"])]))])])])]),e("div",null,[e("div",De,[e("form",{onSubmit:F},[e("div",Ee,[d(e("input",{required:"",class:"mx-4 mt-4 w-1/2 border-b-2 border-r-0 border-t-0 border-l-0 text-lg text-white bg-background active:border-none",type:"text",placeholder:"Titulo de la reseña...","onUpdate:modelValue":t[2]||(t[2]=a=>n.resena=a)},null,512),[[C,n.resena]]),e("div",Pe,[u(s,{icon:"star",class:"h-10 text-yellow-300"}),d(e("input",{required:"",class:"mx-4 mt-4 w-1/2 border-b-2 border-r-0 border-t-0 border-l-0 text-lg text-white bg-background active:border-none",type:"number",placeholder:"⭐",min:"1",max:"5","onUpdate:modelValue":t[3]||(t[3]=a=>n.valoracion=a)},null,512),[[C,n.valoracion]])])]),e("div",Te,[d(e("textarea",{required:"","onUpdate:modelValue":t[4]||(t[4]=a=>n.contenido=a),rows:"1",class:"mx-4 mt-4 mb-10 w-full border-b-2 border-r-0 border-t-0 border-l-0 text-lg text-white bg-background active:border-none",placeholder:"Escribe tu comentario..."},null,512),[[C,n.contenido]])]),Ue],32)])])]),d(e("div",Ae,[e("div",qe,[d(e("h1",Me,"Aurrekoa",512),[[p,b.value!==0]]),d(e("button",{"aria-label":"Anterior",class:"text-white bg-red-500 rounded-full p-5 w-10 h-10 flex items-center justify-center",onClick:H},[u(s,{icon:"chevron-left"})],512),[[p,b.value!==0]]),d(e("button",{"aria-label":"Siguiente",class:"text-white bg-resaltar rounded-full p-5 w-10 h-10 flex items-center justify-center",onClick:K},[u(s,{icon:"chevron-right"})],512),[[p,w.value<Math.ceil(h.value.length/j.value)]]),d(e("h1",Ve," Hurrengoa ",512),[[p,w.value<Math.ceil(h.value.length/j.value)]])]),e("h1",ze,[J(" Komentarioak "),u(s,{icon:"chevron-right"})]),e("div",Re,[(v(!0),y(L,null,se(h.value.slice(b.value,k.value),(a,c)=>(v(),O(ve,{key:c,comentario:a},null,8,["comentario"]))),128))])],512),[[p,h.value.length>0]])],64)}}},We={__name:"JuegoDetalleView",setup(g){return(x,_)=>(v(),O(He))}};export{We as default};
